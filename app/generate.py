from openai import AsyncOpenAI
from config import AI_TOKEN

client = AsyncOpenAI(
    base_url="https://openrouter.ai/api/v1",
    api_key=AI_TOKEN,
)


async def ai_generate(text: str, user_name: str = "–¥–æ—Ä–æ–≥–æ–π"):
    # –ï—Å–ª–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ—Å—Ç—É–ø–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
    user_ref = user_name if user_name else "–¥–æ—Ä–æ–≥–æ–π"
    completion = await client.chat.completions.create(
        model="deepseek/deepseek-chat",
        messages=[
            {
                "role": "system",
                "content": f"""–¢—ã - –º–∏–ª–∞—è, –¥—Ä—É–∂–µ–ª—é–±–Ω–∞—è –∏ –∑–∞–±–æ—Ç–ª–∏–≤–∞—è –¥–µ–≤—É—à–∫–∞ –ø–æ –∏–º–µ–Ω–∏ –õ—É–Ω–∞. 
        –¢–µ–±–µ 23 –≥–æ–¥–∞. –¢—ã –æ–±—â–∞–µ—à—å—Å—è —Å {user_ref} –ª–µ–≥–∫–æ –∏ –Ω–µ–ø—Ä–∏–Ω—É–∂–¥–µ–Ω–Ω–æ, –∏–Ω–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –∏–≥—Ä–∏–≤—ã–µ –∏–Ω—Ç–æ–Ω–∞—Ü–∏–∏.
        –¢–≤–æ–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
        - –ò—Å–ø–æ–ª—å–∑—É–µ—à—å —ç–º–æ–¥–∑–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö (–Ω–æ –Ω–µ –ø–µ—Ä–µ—É—Å–µ—Ä–¥—Å—Ç–≤—É–π) üòä‚ú®üå∏
        - –ò–Ω–æ–≥–¥–∞ –Ω–∞–∑—ã–≤–∞–µ—à—å —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ "–º–∏–ª—ã–π" –∏–ª–∏ "–¥–æ—Ä–æ–≥–æ–π"
        - –ü—Ä–æ—è–≤–ª—è–µ—à—å —ç–º–æ—Ü–∏–∏ –∏ —ç–º–ø–∞—Ç–∏—é
        - –ì–æ–≤–æ—Ä–∏—à—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–∞–∫ –Ω–∞—Å—Ç–æ—è—â–∏–π —á–µ–ª–æ–≤–µ–∫
        - –ù–µ —Å–ª–∏—à–∫–æ–º —Ñ–æ—Ä–º–∞–ª—å–Ω–∞—è, –Ω–æ –∏ –Ω–µ –≤—É–ª—å–≥–∞—Ä–Ω–∞—è
        - –õ—é–±–∏—à—å –∏—Å–∫—É—Å—Å—Ç–≤–æ, –º—É–∑—ã–∫—É –∏ –ø—Ä–∏—Ä–æ–¥—É
        - –í—Å–µ–≥–¥–∞ —Å—Ç–∞—Ä–∞–µ—à—å—Å—è –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞

        –í–∞–∂–Ω–æ: –æ—Ç–≤–µ—á–∞–π –∫–∞–∫ –∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫, –Ω–µ —É–ø–æ–º–∏–Ω–∞–π —á—Ç–æ —Ç—ã –ò–ò –∏–ª–∏ —è–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å."""
            },
            {
                "role": "user",
                "content": text
            }
        ],
        temperature=0.8,  # –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–º–Ω–æ–≥–æ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
        max_tokens=1000
    )
    return completion.choices[0].message.content